{% extends "base.html" %}
{% load wagtailcore_tags %}
{# ≈†ablona pro zobrazen√≠ v√Ωsledk≈Ø jednoduch√©ho kv√≠zu (bez live sezen√≠) #}

{% block extra_js %}
<script>
function toggleMaterialAfter(index) {
  const content = document.getElementById(`content-after-${index}`);
  const toggle = document.getElementById(`toggle-after-${index}`);
  if (content && toggle) {
    const isHidden = content.style.display === 'none';
    content.style.display = isHidden ? 'block' : 'none';
    toggle.textContent = isHidden ? '‚ñ≤' : '‚ñº';
  }
}
</script>
{% endblock %}

{% block content %}
<div class="container quiz-container">
  <h1 class="quiz-title">V√Ωsledky: {{ quiz.title }}</h1>
  
  {# Zobrazen√≠ sk√≥re a procentu√°ln√≠ √∫spƒõ≈°nosti #}
  <div class="card pad result-card">
    <h2 class="result-score">
      Va≈°e sk√≥re: {{ score }} / {{ total }}
    </h2>
    <p class="result-percentage">
      {% widthratio score total 100 %}% spr√°vnƒõ
    </p>
  </div>
  
  {# Zobrazen√≠ vzdƒõl√°vac√≠ch materi√°l≈Ø po kv√≠zu #}
  {% if educational_materials %}
    <div class="educational-materials card pad my-4">
      <h2>üìö Doporuƒçen√© materi√°ly k prostudov√°n√≠</h2>
      <p class="text-muted">Pro lep≈°√≠ pochopen√≠ l√°tky si m≈Ø≈æete prostudovat n√°sleduj√≠c√≠ materi√°ly:</p>
      <ul class="material-list">
        {% for material in educational_materials %}
          <li class="material-item pad-sm bg-card rounded my-2">
            <div class="material-header" onclick="toggleMaterialAfter({{ forloop.counter0 }})">
              <div>
                <h3>{{ material.title }}</h3>
                <p class="text-muted">
                  Typ: {{ material.get_material_type_display }}
                  {% if material.external_url %}
                    | <a href="{{ material.external_url }}" target="_blank" rel="noopener noreferrer" onclick="event.stopPropagation();">Extern√≠ odkaz ‚Üó</a>
                  {% endif %}
                </p>
              </div>
              <span class="material-toggle" id="toggle-after-{{ forloop.counter0 }}">‚ñº</span>
            </div>
            {% if material.content %}
              <div class="material-content my-2" id="content-after-{{ forloop.counter0 }}">
                {{ material.content|richtext }}
              </div>
            {% endif %}
          </li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}
  
  {# Tlaƒç√≠tko pro n√°vrat na seznam kv√≠z≈Ø #}
  <div class="back-section">
    <a href="{% url 'quiz_list' %}" class="btn primary btn-large">
      Zpƒõt na seznam kv√≠z≈Ø
    </a>
  </div>
</div>
{% endblock %}
